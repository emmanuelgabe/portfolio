<!-- Clickable card when hasDetails is true -->
<a
  *ngIf="project.hasDetails"
  [routerLink]="['/projects', project.id]"
  class="card h-100 shadow-sm project-card text-decoration-none"
>
  <ng-container *ngTemplateOutlet="cardContent"></ng-container>
</a>

<!-- Non-clickable card when hasDetails is false -->
<div
  *ngIf="!project.hasDetails"
  class="card h-100 shadow-sm project-card project-card-no-details"
>
  <ng-container *ngTemplateOutlet="cardContent"></ng-container>
</div>

<!-- Shared card content template -->
<ng-template #cardContent>
  <!-- Project Image with explicit dimensions to prevent CLS -->
  <img
    [src]="imageSrc"
    [alt]="project.title"
    class="card-img-top"
    [class.placeholder-image]="!hasImage"
    width="400"
    height="200"
    loading="lazy"
  />

  <div class="card-body d-flex flex-column">
    <!-- Project Title -->
    <h5 class="card-title">{{ project.title }}</h5>

    <!-- Project Description -->
    <p class="card-text text-muted flex-grow-1">
      {{ truncateDescription(project.description) }}
    </p>

    <!-- Tags -->
    <div class="tags-container mb-3">
      <span
        *ngFor="let tag of project.tags"
        class="badge rounded-pill me-1 mb-1"
        [style.background-color]="tag.color || '#6c757d'"
      >
        {{ tag.name }}
      </span>
    </div>

    <!-- Action Links -->
    <div class="card-actions d-flex justify-content-between align-items-center">
      <!-- View Details Link (only shown when hasDetails is true) -->
      <span *ngIf="project.hasDetails" class="view-details-link">
        <i class="bi bi-chevron-right" aria-hidden="true"></i> Voir les détails
      </span>
      <span *ngIf="!project.hasDetails"></span>

      <!-- External Links -->
      <div class="external-links d-flex gap-2">
        <!-- GitHub Link -->
        <a
          *ngIf="hasGithubUrl"
          [href]="project.githubUrl"
          target="_blank"
          rel="noopener noreferrer"
          class="btn btn-outline-secondary btn-sm"
          [attr.aria-label]="'Voir ' + project.title + ' sur GitHub (ouvre dans un nouvel onglet)'"
          (click)="$event.stopPropagation()"
        >
          <i class="bi bi-github" aria-hidden="true"></i>
        </a>

        <!-- Demo Link -->
        <a
          *ngIf="hasDemoUrl"
          [href]="project.demoUrl"
          target="_blank"
          rel="noopener noreferrer"
          class="btn btn-outline-success btn-sm"
          [attr.aria-label]="'Voir la démo de ' + project.title + ' (ouvre dans un nouvel onglet)'"
          (click)="$event.stopPropagation()"
        >
          <i class="bi bi-box-arrow-up-right" aria-hidden="true"></i>
        </a>
      </div>
    </div>
  </div>
</ng-template>
