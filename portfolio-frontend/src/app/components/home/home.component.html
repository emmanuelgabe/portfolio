<!-- Hero Section -->
<section id="hero" class="hero-section">
  <!-- Birds animation background -->
  <div #birdsAnimation class="birds-background"></div>

  <div class="container">
    <div class="row justify-content-center">
      <div class="col-12 col-lg-8">
        <div class="terminal-container mb-4">
          <span class="terminal-text-wrapper">
            <!-- Invisible placeholder to reserve space for full text width -->
            <span class="terminal-text-placeholder">{{ fullText }}|</span>
            <!-- Visible text aligned left within reserved space -->
            <span class="terminal-text-visible">
              <span class="terminal-text">{{ displayedText }}</span><span class="terminal-cursor" [class.blink]="showCursor" *ngIf="displayedText">|</span>
            </span>
          </span>
        </div>
        <div class="lead mb-4 description-container">
          <p class="mb-2 description-line-wrapper" *ngFor="let line of fullDescriptionLines; let i = index">
            <!-- Invisible placeholder to reserve space for full line width -->
            <span class="description-placeholder">{{ line }}</span>
            <!-- Visible text aligned left within reserved space -->
            <span class="description-visible">{{ displayedDescriptionLines[i] }}</span>
          </p>
        </div>
        <div class="d-flex gap-3 justify-content-center justify-content-lg-start flex-wrap hero-buttons">
          <a routerLink="/contact" class="btn-style15">
            <i class="bi bi-envelope"></i>
            {{ 'hero.contactMe' | translate }}
          </a>
          <button
            [disabled]="isLoadingCv"
            (click)="downloadCv()"
            type="button"
            class="btn-style15">
            <i class="bi bi-download"></i>
            {{ 'hero.downloadCv' | translate }}
          </button>
        </div>

      </div>
    </div>
  </div>

  <!-- Scroll down indicator -->
  <div class="scroll-arrow">
    <a href="#skills" class="scroll-link" (click)="scrollToSkills($event)">
      <div #scrollAnimation class="scroll-animation"></div>
    </a>
  </div>
</section>

<!-- Skills Section -->
<section id="skills" class="skills-section py-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="display-5 fw-bold mb-3">{{ 'skills.title' | translate }}</h2>
    </div>
    <div class="skills-container">
      <!-- Loading Skeletons -->
      @if (isLoadingSkills) {
        @for (i of [1,2,3,4,5,6,7,8]; track i) {
          <app-skeleton-skill-card />
        }
      }

      <!-- Skills -->
      @if (!isLoadingSkills) {
        <div class="skill-card" *ngFor="let skill of skills">
          <div class="skill-icon">
            <i *ngIf="skill.iconType === 'FONT_AWESOME'" [class]="skill.icon" [style.color]="skill.color"></i>
            <img *ngIf="skill.iconType === 'CUSTOM_SVG' && skill.customIconUrl" [src]="skill.customIconUrl" [alt]="skill.name" />
          </div>
          <p class="skill-name">{{ skill.name }}</p>
        </div>
      }
    </div>
  </div>
</section>

<!-- Timeline Section -->
<section id="experiences" class="timeline-section py-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="display-5 fw-bold mb-3">{{ 'experiences.title' | translate }}</h2>
    </div>

    <!-- Loading Skeletons -->
    @if (isLoadingExperiences) {
      <div class="timeline-container">
        <div class="timeline-line"></div>
        @for (i of [1,2,3]; track i; let idx = $index) {
          <app-skeleton-timeline-item [position]="idx % 2 === 0 ? 'left' : 'right'" />
        }
      </div>
    }

    <!-- Error Message -->
    @if (experiencesError) {
      <div class="alert alert-danger" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ experiencesError }}
      </div>
    }

    <!-- Timeline -->
    @if (!isLoadingExperiences && !experiencesError && allExperiences.length > 0) {
      <div class="timeline-container">
        <div class="timeline-line"></div>

        @for (experience of allExperiences; track experience.id; let i = $index) {
          <div
            class="timeline-item"
            [ngClass]="i % 2 === 0 ? 'timeline-left' : 'timeline-right'"
          >
            <div class="timeline-marker">
              <i class="bi" [ngClass]="getExperienceIcon(experience.type)"></i>
            </div>

            <div class="timeline-card">
              <div class="timeline-card-header">
                <span class="badge bg-secondary mb-2">
                  {{ getExperienceTypeLabel(experience.type) }}
                </span>
                <h4 class="mb-1">{{ experience.role }}</h4>
                <h5 class="text-muted mb-2">{{ experience.company }}</h5>
                <span class="timeline-date text-muted">
                  <i class="bi bi-calendar3 me-1"></i>
                  {{ formatExperienceDateRange(experience.startDate, experience.endDate) }}
                  @if (experience.ongoing) {
                    <span class="badge bg-success ms-2">{{ 'experiences.ongoing' | translate }}</span>
                  }
                </span>
              </div>

              <div class="timeline-card-body markdown-content" [innerHTML]="renderDescription(experience.description)">
              </div>
            </div>
          </div>
        }
      </div>
    }

    <!-- Empty State -->
    @if (!isLoadingExperiences && !experiencesError && allExperiences.length === 0) {
      <div class="text-center text-muted py-5">
        <i class="bi bi-inbox fs-1 d-block mb-3"></i>
        <p>{{ 'experiences.empty' | translate }}</p>
      </div>
    }
  </div>
</section>

<!-- Projects Section -->
<section id="projects" class="projects-section py-5 bg-light">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="display-5 fw-bold mb-3">{{ 'projects.title' | translate }}</h2>
    </div>

    <!-- Projects content wrapper with min-height to prevent CLS -->
    <div class="projects-content-wrapper">
      <!-- Loading Skeletons -->
      <div *ngIf="isLoadingProjects">
        <div class="row g-4">
          @for (i of [1,2,3]; track i) {
            <div class="col-12 col-md-6 col-lg-4">
              <app-skeleton-project-card />
            </div>
          }
        </div>
      </div>

      <!-- Error Message -->
      <div *ngIf="projectsError" class="alert alert-warning text-center" role="alert">
        <i class="bi bi-exclamation-triangle me-2"></i>
        {{ projectsError }}
      </div>

      <!-- No Projects -->
      <div *ngIf="!isLoadingProjects && !projectsError && !hasProjects" class="text-center py-5">
        <i class="bi bi-inbox display-3 text-muted"></i>
        <p class="lead mt-3 text-muted">{{ 'projects.empty' | translate }}</p>
      </div>

      <!-- Projects Grid -->
      <div *ngIf="!isLoadingProjects && !projectsError && hasProjects">
        <!-- Featured Projects Section -->
        <div *ngIf="featuredProjects.length > 0" class="mb-4">
          <div class="row g-4">
            <div class="col-12 col-md-6 col-lg-4" *ngFor="let project of featuredProjects">
              <app-project-card [project]="project"></app-project-card>
            </div>
          </div>
        </div>

        <!-- Other Projects Section (shown when expanded) -->
        <div *ngIf="showAllProjects && otherProjects.length > 0" class="mt-5">
          <div class="row g-4">
            <div class="col-12 col-md-6 col-lg-4" *ngFor="let project of otherProjects">
              <app-project-card [project]="project"></app-project-card>
            </div>
          </div>
        </div>

        <!-- Toggle Button -->
        <div *ngIf="hasMoreProjects" class="text-center mt-5">
          <button
            (click)="toggleShowAllProjects()"
            class="btn btn-outline-primary btn-lg"
          >
            <i [class]="showAllProjects ? 'bi bi-chevron-up me-2' : 'bi bi-grid-3x3-gap me-2'"></i>
            <span *ngIf="!showAllProjects">{{ 'projects.viewAll' | translate }} ({{ allProjects.length }})</span>
            <span *ngIf="showAllProjects">{{ 'projects.viewLess' | translate }}</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Articles Section - shown during loading to prevent CLS -->
<section id="articles" class="articles-section py-5" *ngIf="isLoadingArticles || hasArticles">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="display-5 fw-bold mb-3">{{ 'articles.title' | translate }}</h2>
    </div>

    <div class="articles-content-wrapper">
      <!-- Loading Skeletons -->
      @if (isLoadingArticles) {
        <div class="row g-4">
          @for (i of [1,2,3]; track i) {
            <div class="col-12 col-md-6 col-lg-4">
              <app-skeleton-article-card />
            </div>
          }
        </div>
      }

      <!-- Error Message -->
      @if (articlesError) {
        <div class="alert alert-danger" role="alert">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          {{ articlesError }}
        </div>
      }

      <!-- Articles Grid -->
      @if (!isLoadingArticles && !articlesError && hasArticles) {
        <div class="row g-4">
          <div class="col-12 col-md-6 col-lg-4" *ngFor="let article of latestArticles">
            <app-article-card [article]="article"></app-article-card>
          </div>
        </div>

        <!-- Link to all articles (only if 3 or more) -->
        @if (latestArticles.length >= 3) {
          <div class="text-center mt-5">
            <a routerLink="/blog" class="btn btn-outline-primary btn-lg">
              <i class="bi bi-journal-text me-2"></i>
              {{ 'articles.viewAll' | translate }}
            </a>
          </div>
        }
      }
    </div>
  </div>
</section>
