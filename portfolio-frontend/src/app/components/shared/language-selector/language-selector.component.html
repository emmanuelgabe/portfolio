<div class="language-selector" (clickOutside)="closeDropdown()">
  <button
    type="button"
    class="language-toggle"
    (click)="toggleDropdown()"
    [attr.aria-expanded]="isOpen"
    aria-haspopup="listbox"
    aria-label="Select language">
    <i class="bi bi-globe2" aria-hidden="true"></i>
    <span class="lang-code">{{ currentLang | uppercase }}</span>
    <i class="bi bi-chevron-down chevron" [class.rotate]="isOpen" aria-hidden="true"></i>
  </button>

  <ul
    *ngIf="isOpen"
    class="language-dropdown"
    role="listbox"
    aria-label="Available languages">
    <li
      *ngFor="let lang of languages"
      role="option"
      [attr.aria-selected]="lang.code === currentLang"
      class="language-option"
      [class.active]="lang.code === currentLang"
      (click)="selectLanguage(lang)"
      (keydown)="onKeydown($event, lang)"
      tabindex="0">
      <span class="lang-label">{{ lang.label }}</span>
      <i *ngIf="lang.code === currentLang" class="bi bi-check2" aria-hidden="true"></i>
    </li>
  </ul>
</div>
