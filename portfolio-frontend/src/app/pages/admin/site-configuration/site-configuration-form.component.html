<div class="site-config-form">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>{{ 'admin.siteConfig.title' | translate }}</h1>
    <button type="button" class="btn btn-outline-secondary" (click)="goBack()">
      <i class="bi bi-arrow-left me-2"></i>
      {{ 'admin.common.back' | translate }}
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-success" role="status">
      <span class="visually-hidden">{{ 'admin.common.loading' | translate }}</span>
    </div>
  </div>

  <!-- Form -->
  <div *ngIf="!loading">
    <form [formGroup]="configForm" (ngSubmit)="onSubmit()">
      <!-- Profile Image Section -->
      <div class="card shadow-sm mb-4">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-person-circle me-2"></i>{{ 'admin.siteConfig.profileImage' | translate }}</h5>
        </div>
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-auto">
              <div class="profile-image-container">
                <img
                  *ngIf="imagePreview || profileImageUrl"
                  [src]="imagePreview || profileImageUrl"
                  [alt]="'admin.siteConfig.profileImage' | translate"
                  class="profile-image"
                />
                <div *ngIf="!imagePreview && !profileImageUrl" class="profile-placeholder">
                  <i class="bi bi-person-fill"></i>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="mb-3">
                <input
                  type="file"
                  class="form-control"
                  id="profileImage"
                  accept="image/jpeg,image/png,image/webp"
                  (change)="onFileSelected($event)"
                  [disabled]="demoModeService.isDemo() || uploadingImage"
                />
                <div class="form-text">{{ 'admin.siteConfig.imageFormats' | translate }}</div>
              </div>
              <div class="d-flex gap-2">
                <button
                  *ngIf="selectedFile"
                  type="button"
                  class="btn btn-success btn-sm"
                  (click)="uploadProfileImage()"
                  [disabled]="uploadingImage || demoModeService.isDemo()"
                >
                  <span *ngIf="!uploadingImage">
                    <i class="bi bi-upload me-1"></i> {{ 'admin.common.upload' | translate }}
                  </span>
                  <span *ngIf="uploadingImage">
                    <div class="spinner-border spinner-border-sm me-1" role="status"></div>
                    {{ 'admin.common.sending' | translate }}
                  </span>
                </button>
                <button
                  *ngIf="selectedFile"
                  type="button"
                  class="btn btn-outline-secondary btn-sm"
                  (click)="cancelImageSelection()"
                  [disabled]="uploadingImage"
                >
                  {{ 'admin.common.cancel' | translate }}
                </button>
                <button
                  *ngIf="profileImageUrl && !selectedFile"
                  type="button"
                  class="btn btn-outline-danger btn-sm"
                  (click)="deleteProfileImage()"
                  [disabled]="uploadingImage || demoModeService.isDemo()"
                >
                  <i class="bi bi-trash me-1"></i> {{ 'admin.common.delete' | translate }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Identity Section -->
      <div class="card shadow-sm mb-4">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-person me-2"></i>{{ 'admin.siteConfig.identity' | translate }}</h5>
        </div>
        <div class="card-body">
          <!-- Full Name -->
          <div class="mb-3">
            <label for="fullName" class="form-label">
              {{ 'admin.siteConfig.fullName' | translate }} <span class="text-danger">*</span>
            </label>
            <input
              type="text"
              id="fullName"
              class="form-control"
              formControlName="fullName"
              [class.is-invalid]="isFieldInvalid('fullName')"
              [readonly]="demoModeService.isDemo()"
              [placeholder]="'admin.siteConfig.fullNamePlaceholder' | translate"
            />
            <div class="invalid-feedback" *ngIf="hasError('fullName', 'required')">
              {{ 'admin.siteConfig.fullNameRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('fullName', 'minlength')">
              {{ 'admin.validation.minLength' | translate:{ min: 2 } }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('fullName', 'maxlength')">
              {{ 'admin.validation.maxLength' | translate:{ max: 100 } }}
            </div>
          </div>

          <!-- Email -->
          <div class="mb-3">
            <label for="email" class="form-label">
              {{ 'admin.siteConfig.email' | translate }} <span class="text-danger">*</span>
            </label>
            <input
              type="email"
              id="email"
              class="form-control"
              formControlName="email"
              [class.is-invalid]="isFieldInvalid('email')"
              [readonly]="demoModeService.isDemo()"
              [placeholder]="'admin.siteConfig.emailPlaceholder' | translate"
            />
            <div class="invalid-feedback" *ngIf="hasError('email', 'required')">
              {{ 'admin.siteConfig.emailRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('email', 'email')">
              {{ 'admin.validation.invalidEmail' | translate }}
            </div>
          </div>
        </div>
      </div>

      <!-- Hero Section -->
      <div class="card shadow-sm mb-4">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-stars me-2"></i>{{ 'admin.siteConfig.heroSection' | translate }}</h5>
        </div>
        <div class="card-body">
          <p class="text-muted mb-3">
            {{ 'admin.siteConfig.heroDescription' | translate }}
          </p>

          <!-- Hero Title -->
          <div class="mb-3">
            <label for="heroTitle" class="form-label">
              {{ 'admin.siteConfig.heroTitle' | translate }} <span class="text-danger">*</span>
            </label>
            <input
              type="text"
              id="heroTitle"
              class="form-control"
              formControlName="heroTitle"
              [class.is-invalid]="isFieldInvalid('heroTitle')"
              [readonly]="demoModeService.isDemo()"
              [placeholder]="'admin.siteConfig.heroTitlePlaceholder' | translate"
            />
            <div class="invalid-feedback" *ngIf="hasError('heroTitle', 'required')">
              {{ 'admin.siteConfig.heroTitleRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('heroTitle', 'minlength')">
              {{ 'admin.validation.minLength' | translate:{ min: 2 } }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('heroTitle', 'maxlength')">
              {{ 'admin.validation.maxLength' | translate:{ max: 200 } }}
            </div>
          </div>

          <!-- Hero Description -->
          <div class="mb-3">
            <label for="heroDescription" class="form-label">
              {{ 'admin.siteConfig.heroDescriptionLabel' | translate }} <span class="text-danger">*</span>
            </label>
            <textarea
              id="heroDescription"
              class="form-control"
              formControlName="heroDescription"
              [class.is-invalid]="isFieldInvalid('heroDescription')"
              [readonly]="demoModeService.isDemo()"
              rows="4"
              [placeholder]="'admin.siteConfig.heroDescriptionPlaceholder' | translate"
            ></textarea>
            <div class="invalid-feedback" *ngIf="hasError('heroDescription', 'required')">
              {{ 'admin.siteConfig.heroDescriptionRequired' | translate }}
            </div>
          </div>
        </div>
      </div>

      <!-- SEO Section -->
      <div class="card shadow-sm mb-4">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-search me-2"></i>{{ 'admin.siteConfig.seoSection' | translate }}</h5>
        </div>
        <div class="card-body">
          <p class="text-muted mb-3">
            {{ 'admin.siteConfig.seoDescription' | translate }}
          </p>

          <!-- Site Title -->
          <div class="mb-3">
            <label for="siteTitle" class="form-label">
              {{ 'admin.siteConfig.siteTitle' | translate }} <span class="text-danger">*</span>
            </label>
            <input
              type="text"
              id="siteTitle"
              class="form-control"
              formControlName="siteTitle"
              [class.is-invalid]="isFieldInvalid('siteTitle')"
              [readonly]="demoModeService.isDemo()"
              [placeholder]="'admin.siteConfig.siteTitlePlaceholder' | translate"
            />
            <div class="form-text">{{ 'admin.siteConfig.siteTitleHelp' | translate }}</div>
            <div class="invalid-feedback" *ngIf="hasError('siteTitle', 'required')">
              {{ 'admin.siteConfig.siteTitleRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('siteTitle', 'maxlength')">
              {{ 'admin.validation.maxLength' | translate:{ max: 100 } }}
            </div>
          </div>

          <!-- SEO Description -->
          <div class="mb-3">
            <label for="seoDescription" class="form-label">
              {{ 'admin.siteConfig.metaDescription' | translate }} <span class="text-danger">*</span>
            </label>
            <textarea
              id="seoDescription"
              class="form-control"
              formControlName="seoDescription"
              [class.is-invalid]="isFieldInvalid('seoDescription')"
              [readonly]="demoModeService.isDemo()"
              rows="3"
              [placeholder]="'admin.siteConfig.metaDescriptionPlaceholder' | translate"
              maxlength="300"
            ></textarea>
            <div class="form-text">
              {{ configForm.get('seoDescription')?.value?.length || 0 }}/300 {{ 'admin.siteConfig.characters' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('seoDescription', 'required')">
              {{ 'admin.siteConfig.metaDescriptionRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('seoDescription', 'maxlength')">
              {{ 'admin.validation.maxLength' | translate:{ max: 300 } }}
            </div>
          </div>
        </div>
      </div>

      <!-- Social Links Section -->
      <div class="card shadow-sm mb-4">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-link-45deg me-2"></i>{{ 'admin.siteConfig.socialLinks' | translate }}</h5>
        </div>
        <div class="card-body">
          <!-- GitHub URL -->
          <div class="mb-3">
            <label for="githubUrl" class="form-label">
              <i class="bi bi-github me-1"></i>GitHub <span class="text-danger">*</span>
            </label>
            <input
              type="url"
              id="githubUrl"
              class="form-control"
              formControlName="githubUrl"
              [class.is-invalid]="isFieldInvalid('githubUrl')"
              [readonly]="demoModeService.isDemo()"
              placeholder="https://github.com/username"
            />
            <div class="invalid-feedback" *ngIf="hasError('githubUrl', 'required')">
              {{ 'admin.siteConfig.githubUrlRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('githubUrl', 'pattern')">
              {{ 'admin.validation.invalidUrl' | translate }}
            </div>
          </div>

          <!-- LinkedIn URL -->
          <div class="mb-3">
            <label for="linkedinUrl" class="form-label">
              <i class="bi bi-linkedin me-1"></i>LinkedIn <span class="text-danger">*</span>
            </label>
            <input
              type="url"
              id="linkedinUrl"
              class="form-control"
              formControlName="linkedinUrl"
              [class.is-invalid]="isFieldInvalid('linkedinUrl')"
              [readonly]="demoModeService.isDemo()"
              placeholder="https://linkedin.com/in/username"
            />
            <div class="invalid-feedback" *ngIf="hasError('linkedinUrl', 'required')">
              {{ 'admin.siteConfig.linkedinUrlRequired' | translate }}
            </div>
            <div class="invalid-feedback" *ngIf="hasError('linkedinUrl', 'pattern')">
              {{ 'admin.validation.invalidUrl' | translate }}
            </div>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="d-flex justify-content-between pt-3">
        <button type="button" class="btn btn-outline-secondary" (click)="goBack()">
          {{ 'admin.common.cancel' | translate }}
        </button>
        <button
          type="submit"
          class="btn btn-success"
          [disabled]="configForm.invalid || submitting || demoModeService.isDemo()"
          [style.opacity]="demoModeService.isDemo() ? '0.65' : '1'"
          [title]="demoModeService.isDemo() ? ('admin.common.demoModeDisabled' | translate) : ''"
        >
          <span *ngIf="!submitting">
            <i class="bi bi-check-lg me-2"></i>
            {{ 'admin.common.save' | translate }}
          </span>
          <span *ngIf="submitting">
            <div class="spinner-border spinner-border-sm me-2" role="status">
              <span class="visually-hidden">{{ 'admin.common.sending' | translate }}</span>
            </div>
            {{ 'admin.common.sending' | translate }}
          </span>
        </button>
      </div>
    </form>
  </div>
</div>
