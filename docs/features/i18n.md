# Internationalization (i18n)

Multi-language support with ngx-translate and RTL layout handling.

---

## Table of Contents

1. [Overview](#overview)
2. [Architecture](#architecture)
3. [Supported Languages](#supported-languages)
4. [Usage](#usage)
5. [Configuration](#configuration)
6. [Related Documentation](#related-documentation)

---

## Overview

The internationalization system provides:

- **10 languages** - Including non-Latin scripts
- **RTL support** - Arabic with right-to-left layout
- **Persistence** - Language preference saved locally
- **Auto-detection** - Browser language detection on first visit

Key characteristics:
- ngx-translate library
- JSON translation files
- Signal-based reactive updates
- Lazy loading of translations

---

## Architecture

### Frontend Components

| Component | Location | Purpose |
|-----------|----------|---------|
| `LanguageService` | `services/` | Language management |
| `LanguageSelectorComponent` | `components/shared/` | UI selector dropdown |
| `TranslateModule` | `@ngx-translate/core` | Translation pipe and service |

### Translation Files

```
src/assets/i18n/
├── ar.json   # Arabic (RTL)
├── de.json   # German
├── en.json   # English
├── es.json   # Spanish
├── fr.json   # French (default)
├── hi.json   # Hindi
├── ja.json   # Japanese
├── pt.json   # Portuguese
├── ru.json   # Russian
└── zh.json   # Chinese
```

---

## Supported Languages

| Code | Language | Script | Direction |
|------|----------|--------|-----------|
| `fr` | Fran | Latin | LTR |
| `en` | English | Latin | LTR |
| `es` | Espa | Latin | LTR |
| `pt` | Portugu | Latin | LTR |
| `de` | Deutsch | Latin | LTR |
| `zh` | Chinese | CJK | LTR |
| `ja` | Japanese | CJK | LTR |
| `ru` | Russian | Cyrillic | LTR |
| `ar` | Arabic | Arabic | RTL |
| `hi` | Hindi | Devanagari | LTR |

---

## Usage

### Template Translation

Using translate pipe:

```html
<h1>{{ 'home.title' | translate }}</h1>
<p>{{ 'home.description' | translate }}</p>
```

With parameters:

```html
<p>{{ 'greeting.welcome' | translate: { name: userName } }}</p>
```

### Component Translation

Programmatic access:

```typescript
export class MyComponent {
  private readonly languageService = inject(LanguageService);

  getMessage(): string {
    return this.languageService.instant('messages.success');
  }
}
```

### Language Switching

```typescript
// Change language
this.languageService.setLanguage('en');

// Get current language
const currentLang = this.languageService.getCurrentLanguage();

// Subscribe to changes
effect(() => {
  const lang = this.languageService.currentLang();
  console.log('Language changed to:', lang);
});
```

---

## Configuration

### LanguageService Implementation

```typescript
@Injectable({ providedIn: 'root' })
export class LanguageService {
  private readonly STORAGE_KEY = 'preferred-language';
  private readonly DEFAULT_LANG = 'fr';
  private readonly SUPPORTED_LANGS = ['en', 'fr', 'es', 'pt', 'de', 'zh', 'ja', 'ru', 'ar', 'hi'];
  private readonly RTL_LANGS = ['ar'];

  readonly currentLang = signal<string>(this.DEFAULT_LANG);

  initialize(): void {
    const savedLang = localStorage.getItem(this.STORAGE_KEY);
    const browserLang = this.translate.getBrowserLang();

    let lang = this.DEFAULT_LANG;
    if (savedLang && this.SUPPORTED_LANGS.includes(savedLang)) {
      lang = savedLang;
    } else if (browserLang && this.SUPPORTED_LANGS.includes(browserLang)) {
      lang = browserLang;
    }

    this.setLanguage(lang);
  }

  setLanguage(lang: string): void {
    this.translate.use(lang);
    this.currentLang.set(lang);
    localStorage.setItem(this.STORAGE_KEY, lang);
    document.documentElement.lang = lang;
    document.documentElement.dir = this.RTL_LANGS.includes(lang) ? 'rtl' : 'ltr';
  }
}
```

### App Initialization

```typescript
// main.ts
import { TranslateLoader, TranslateModule } from '@ngx-translate/core';
import { TranslateHttpLoader } from '@ngx-translate/http-loader';

export function HttpLoaderFactory(http: HttpClient) {
  return new TranslateHttpLoader(http, './assets/i18n/', '.json');
}

bootstrapApplication(AppComponent, {
  providers: [
    importProvidersFrom(
      TranslateModule.forRoot({
        loader: {
          provide: TranslateLoader,
          useFactory: HttpLoaderFactory,
          deps: [HttpClient]
        }
      })
    )
  ]
});
```

### Translation File Structure

```json
{
  "nav": {
    "home": "Accueil",
    "blog": "Blog",
    "contact": "Contact"
  },
  "home": {
    "title": "Bienvenue",
    "description": "D"
  },
  "contact": {
    "form": {
      "name": "Nom",
      "email": "Email",
      "message": "Message",
      "submit": "Envoyer"
    }
  }
}
```

---

## RTL Support

Arabic language triggers RTL layout:

```typescript
setLanguage(lang: string): void {
  document.documentElement.dir = this.RTL_LANGS.includes(lang) ? 'rtl' : 'ltr';
}
```

CSS considerations:

```css
/* Automatic mirroring with logical properties */
.sidebar {
  margin-inline-start: 1rem;
  padding-inline-end: 2rem;
}

/* RTL-specific overrides */
[dir="rtl"] .icon-arrow {
  transform: scaleX(-1);
}
```

---

## Related Documentation

- [Frontend Architecture](../architecture/frontend-architecture.md) - Angular setup
- [SEO](./seo.md) - Meta tags with language support

